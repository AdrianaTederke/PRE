{% extends "projetos/index.html" %} {% load staticfiles %} {% block headercss %}
<link href="{% static 'assets/morris.js-0.4.3/morris.css' %}" rel="stylesheet" /> {% endblock headercss %} {% block content %}
<section id="main-content">
    <section class="wrapper">
        <!-- page start-->
        <aside class="profile-info col-lg-12">
            <section class="panel">
                <div class="row">
                    {% include "projetos/menu.html" %} </div>
                <div class="bio-graph-heading">
                    PRE - UFSM
                </div>
                </div>
            </section>
            <section>
                <div id="morris">
                    <div class="row">
                        <div class="col-lg-6">
                            <section class="panel">
                                <header class="panel-heading">
                                    Filtro de Situação dos Projetos por Ano
                                    <form id="frm_pesquisa" method="post" action="{% url request|viewname %}">
                                        {% csrf_token %}
                                        <div class="input-group m-bot30 col-lg-4">
                                            <select name="filter_year1" class="form-control m-bot30">
                                                <option {% if filtro_valor == 'Todos' %}selected{% endif %}>Todos</option>
                                                <option {% if filtro_valor == '2015' %}selected{% endif %}>2015</option>
                                                <option {% if filtro_valor == '2014' %}selected{% endif %}>2014</option>
                                                <option {% if filtro_valor == '2013' %}selected{% endif %}>2013</option>
                                                <option {% if filtro_valor == '2012' %}selected{% endif %}>2012</option>
                                                <option {% if filtro_valor == '2011' %}selected{% endif %}>2011</option>
                                                <option {% if filtro_valor == '2010' %}selected{% endif %}>2010</option>
                                                <option {% if filtro_valor == '2009' %}selected{% endif %}>2009</option>
                                                <option {% if filtro_valor == '2008' %}selected{% endif %}>2008</option>
                                                <option {% if filtro_valor == '2007' %}selected{% endif %}>2007</option>
                                                <option {% if filtro_valor == '2006' %}selected{% endif %}>2006</option>
                                                <option {% if filtro_valor == '2005' %}selected{% endif %}>2005</option>
                                                <option {% if filtro_valor == '2004' %}selected{% endif %}>2004</option>
                                                <option {% if filtro_valor == '2003' %}selected{% endif %}>2003</option>
                                            </select>
                                            <span class="input-group-btn">
                                              <button type="submit" class="btn btn-white" type="button">Filtrar</button>
                                            </span>
                                        </div>
                                    </form>
                                </header>
                                <div class="panel-body text-center">
                                    <canvas id="pie_situacao" width="300"></canvas>
                                </div>
                                <div id="legend_situacao"></div>
                            </section>
                        </div>
                        <div class="col-lg-6">
                            <section class="panel">
                                <header class="panel-heading">
                                    Participantes / Vinculo
                                </header>
                                <form id="frm_pesquisa" method="post" action="{% url request|viewname %}">
                                    {% csrf_token %}
                                    <div class="input-group m-bot30 col-lg-4">
                                        <select name="filter_year2" class="form-control m-bot30">
                                            <option {% if filtro_valor == 'Todos' %}selected{% endif %}>Todos</option>
                                            <option {% if filtro_valor == '2015' %}selected{% endif %}>2015</option>
                                            <option {% if filtro_valor == '2014' %}selected{% endif %}>2014</option>
                                            <option {% if filtro_valor == '2013' %}selected{% endif %}>2013</option>
                                            <option {% if filtro_valor == '2012' %}selected{% endif %}>2012</option>
                                            <option {% if filtro_valor == '2011' %}selected{% endif %}>2011</option>
                                            <option {% if filtro_valor == '2010' %}selected{% endif %}>2010</option>
                                            <option {% if filtro_valor == '2009' %}selected{% endif %}>2009</option>
                                            <option {% if filtro_valor == '2008' %}selected{% endif %}>2008</option>
                                            <option {% if filtro_valor == '2007' %}selected{% endif %}>2007</option>
                                            <option {% if filtro_valor == '2006' %}selected{% endif %}>2006</option>
                                            <option {% if filtro_valor == '2005' %}selected{% endif %}>2005</option>
                                            <option {% if filtro_valor == '2004' %}selected{% endif %}>2004</option>
                                            <option {% if filtro_valor == '2003' %}selected{% endif %}>2003</option>
                                        </select>
                                        <span class="input-group-btn">
                                          <button type="submit" class="btn btn-white" type="button">Filtrar</button>
                                        </span>
                                    </div>
                                </form>
                                <div class="panel-body text-center">
                                    <canvas id="pie_vinculo" width="300"></canvas>
                                </div>
                                <div id="legend_vinculo"></div>
                            </section>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-12">
                            <section class="panel">
                                <header class="panel-heading">
                                    Projetos / Ano
                                </header>
                                <div class="panel-body text-center">
                                    <canvas id="pie_projetos_por_ano" width="600" height="400"></canvas>
                                </div>
                                <div id="legend_projetos_por_ano"></div>
                            </section>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-12">
                            <section class="panel">
                                <heai proader class="panel-heading">
                                    Projetos / Departamento
                                    </header>
                                    <div class="panel-body">
                                        <div id="bar_departamento" class="graph"></div>
                                    </div>
                            </section>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-12">
                            <section class="panel">
                                <header class="panel-heading">
                                    Projetos / Unidade
                                </header>
                                <div class="panel-body">
                                    <div id="bar_unidade_proj" class="graph"></div>
                                </div>
                            </section>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-12">
                            <section class="panel">
                                <header class="panel-heading">
                                    Participantes / Unidade
                                </header>
                                <div class="panel-body">
                                    <div id="bar_unidade_part" class="graph"></div>
                                </div>
                            </section>
                        </div>
                    </div>
                </div>
            </section>
        </aside>
        </div>
        <!-- page end-->
    </section>
</section>
{% endblock content %} {% block pluginsjs %}
<script src="{% static 'assets/chart-master/Chart2.js' %}"></script>
<script src="{% static 'assets/morris.js-0.4.3/morris.min.js' %}" type="text/javascript"></script>
<script src="{% static 'assets/morris.js-0.4.3/raphael-min.js' %}" type="text/javascript"></script>
<script src="{% static 'assets/jquery-knob/js/jquery.knob.js' %}"></script>
{% endblock pluginsjs %} {% block js-foot %}
<script>
    $(function() {
      $(".knob").knob({
        'draw' : function () { 
          $(this.i).val(this.cv + '%')
        }
      });
      var pieSituacaoData = [
          {% for k, v in projeto_situacao.items %}
          {
              value: {{ v }},
              color: '{{ ''|ramdom_color }}',
              label: "{{ k }}"
          },
          {% endfor %}
      ];
      var pieVinculoData = [
          {% for k, v in vinculo_participantes.items %}
          {
              value: {{ v }},
              color: '{{ ''|ramdom_color }}',
              label: "{{ k }}"
          },
          {% endfor %}
      ];
      var pieProjetosPorAnoData = [
          {% for k, v in projetos_por_ano.items %}
          {
              value: {{ v }},
              color: '{{ ''|ramdom_color }}',
              label: "{{ k }}"
          },
          {% endfor %}
      ];
      myPieSituacao = new Chart(document.getElementById("pie_situacao").getContext("2d")).Pie(pieSituacaoData, {
          legendTemplate : '{{ legend_template|safe }}'
      });
      $("#legend_situacao").html(myPieSituacao.generateLegend());
      myPieVinculo = new Chart(document.getElementById("pie_vinculo").getContext("2d")).Pie(pieVinculoData, {
          legendTemplate : '{{ legend_template|safe }}'
      });
      $("#legend_vinculo").html(myPieVinculo.generateLegend());
      myPieProjetosPorAno = new Chart(document.getElementById("pie_projetos_por_ano").getContext("2d")).Pie(pieProjetosPorAnoData, {
          legendTemplate : '{{ legend_template|safe }}'
      });
      //ESCREVE A LEGENDA DE PROJETOS POR ANO
      //$("#legend_projetos_por_ano").html(myPieProjetosPorAno.generateLegend());
      var barDepartamentoData = [
          {% for k, v in projeto_departamento.items %}
            { departamento: '{{ k }}', projetos: {{ v }} },
          {% endfor %}
      ]
      Morris.Bar({
        element: 'bar_departamento',
        data: barDepartamentoData,
        xkey: 'departamento',
        ykeys: ['projetos'],
        labels: ['Projetos'],
        barRatio: 0.4,
        xLabelAngle: 35,
        hideHover: 'auto',
        barColors: ['#6883a3']
      });
      var barProjUnidadeData = [
          {% for k, v in projeto_unidade.items %}
            { unidade: '{{ k }}', projetos: {{ v }} },
          {% endfor %}
      ]
      Morris.Bar({
        element: 'bar_unidade_proj',
        data: barProjUnidadeData,
        xkey: 'unidade',
        ykeys: ['projetos'],
        labels: ['Projetos'],
        barRatio: 0.4,
        xLabelAngle: 35,
        hideHover: 'auto',
        barColors: ['#6883a3']
      });
      var barPartUnidadeData = [
          {% for k, v in participante_unidade.items %}
            { unidade: '{{ k }}', partipante: {{ v }} },
          {% endfor %}
      ]
      Morris.Bar({
        element: 'bar_unidade_part',
        data: barPartUnidadeData,
        xkey: 'unidade',
        ykeys: ['partipante'],
        labels: ['Participantes'],
        barRatio: 0.4,
        xLabelAngle: 35,
        hideHover: 'auto',
        barColors: ['#6883a3']
      });
    });
</script>
{% endblock %}
</body>

</html>
